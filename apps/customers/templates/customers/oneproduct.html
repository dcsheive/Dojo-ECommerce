{% extends 'customers/custindex.html' %}

{% block title %} Product #{{prod.id}} {%endblock%}

{% block singleprod %}

<nav class='navbar navbar-inverse'>
    <div class='container-fluid'>
        <div class='nav navbar-nav navbar-header'>
            <a class='navbar-brand active' href='{% url 'dashboard' %}'>CodingDojo E-Commerce</a>             
            <li><a><span class='glyphicon glyphicon-user'></span> {{request.session.customer}}</a></li>
        </div>
        <ul class='nav navbar-nav navbar-right menu'>
            <li><a href='{% url 'shoppingcart' %}'><span class='glyphicon glyphicon-shopping-cart'></span> Shopping Cart ({{request.session.shoppingcart|length}})</a></li>  
            <li><a href='{% url 'customerlogout' %}'><span class='glyphicon glyphicon-log-out'></span> Logout</a></li>                        
        </ul>
    </div>
</nav>

<div class='row'>
    <div class="col-md-3" id='prod'>
        <h2>{{prod.name}}</h2>
        <img class='productimg' src={{prod.image.url}}>
    </div>

    <div class='col-md-4' id='desc'>
        <br><br>
        <p class='proddesc'>{{prod.desc}}</p>
        <p class='proddesc'><b>Price</b>: ${{prod.price}}</p>
    </div>

    <div class="col-md-3" id='purchase'>
        <div class='panel panel-default sidebar'>
            <div class='panel-heading'>
                <h3 class='panel-title'>Add to cart</h3>
            </div>
            <div class='panel-body'>
                <form action='{% url 'purchase' id=prod.id %}' method='post'>
                {% csrf_token %}
                    {% if messages %}
                        {% for message in messages %}
                            {% if message.extra_tags == 'quantity' %}
                                <p class="{{message.tags}}">{{message}}</p>
                            {% endif %}
                        {% endfor %}
                    {% endif %}
                    <label for='quan'>Quantity:</label>
                    <input class='form-control' type='number' min='1' name='quantity' id='quan'>
                    <br>
                    <button type='submit'><h3><span class='glyphicon glyphicon-shopping-cart'></span></h3></button>
                </form>
            </div>
        </div>
        {% if messages %}
            {% for message in messages %}
                {% if message.extra_tags == 'addedcart' %}
                    <p class="{{message.tags}}">{{message}}</p>
                {% endif %}
            {% endfor %}
        {% endif %}
    </div>
</div>
<div class='row' id='similar'>
    <h2>Customers also bought (first 5):</h2>
    {% for prod in similarprods %}
    <div class='col-md-2'>
        <a href='{% url 'oneprod' id=prod.id %}'><img class='simprods' src={{prod.image.url}}></a>
        <span class='simdesc'>
            <p><b>{{prod.name}}</b></p>
            <p>${{prod.price}}</p>
        </span>
    </div>
    {% endfor %}
</div>

{% endblock %}